---

layout: single  
author: Huijo  
date: 2025-07-07
tags:  
   - Math
classes: wide  
title: "Prediction Interval, Confidence Interval"
---

## Prediction Interval and Confidence Interval

As it has multiple approaches to explain concepts, I'll utilize a few comparisons.

### High level explanation

Confidence intervals tell you about how well you have determined the mean. Assume that the data really are randomly sampled from a Gaussian distribution. If you do this many times, and calculate a confidence interval of the mean from each sample, you'd expect about 95 % of those intervals to include the true value of the population mean. The key point is that the confidence interval tells you about the likely location of the true population parameter.

Prediction intervals tell you where you can expect to see the next data point sampled. Assume that the data really are randomly sampled from a Gaussian distribution. Collect a sample of data and calculate a prediction interval. Then sample one more value from the population. If you do this many times, you'd expect that next value to lie within that prediction interval in 95% of the samples.The key point is that the prediction interval tells you about the distribution of values, not the uncertainty in determining the population mean.

Prediction intervals must account for both the uncertainty in knowing the value of the population mean, plus data scatter (variance). So a prediction interval is always wider than a confidence interval.

### Standard Error-related explanation

The difference between a prediction interval and a confidence interval is the standard error.

The standard error for a **confidence interval** on the mean takes into account the **uncertainty due to sampling**. The line you computed from your sample will be different from the line that would have been computed if you had the entire population, the standard error takes this uncertainty into account.

The standard error for a **prediction interval** on an individual observation takes into account the uncertainty due to sampling like above, but also takes into account the **variability of the individuals around the predicted mean**. The standard error for the prediction interval will be wider than for the confidence interval and hence the prediction interval will be wider than the confidence interval.

### Mathematical Explanation

Let's consider a simple linear regression model:

$$ y = \alpha + \beta x + \epsilon $$

where:

- `y` is the response variable.
- `x` is the explanatory variable.
- `α` and `β` are the model parameters (intercept and slope).
- `ε` is the random error term, assumed to be normally distributed with a mean of 0 and variance `σ²`.

Our goal is to estimate `y` for a given `x`. We use a sample of data to get estimates for the parameters, denoted as `α̂` and `β̂`.

#### Confidence Interval for the Mean Response

A confidence interval provides a range for the **average** value of `y` for a given `x`. The uncertainty here comes from the fact that our estimated parameters `α̂` and `β̂` are based on a sample, not the entire population.

The formula for a (1 - α) * 100% confidence interval for the mean response `E(y|x)` is:

$$ \hat{y} \pm t_{n-2, \alpha/2} \cdot \sqrt{MSE \left( \frac{1}{n} + \frac{(x - \bar{x})^2}{\sum(x_i - \bar{x})^2} \right)} $$

Where:

- `ŷ` is the predicted mean response for a given `x`.
- `t` is the critical value from the t-distribution with `n-2` degrees of freedom.
- `MSE` is the Mean Squared Error, which is our estimate for the error variance `σ²`.
- `n` is the sample size.
- `x̄` is the mean of the explanatory variable in our sample.

This interval accounts for the uncertainty in estimating the regression line itself.

#### Prediction Interval for a New Observation

A prediction interval provides a range for a **single future observation** of `y` for a given `x`. This must account for two sources of uncertainty:

1. The uncertainty in estimating the regression line (same as the confidence interval).
2. The inherent variability of an individual data point around the true regression line (`σ²`).

The formula for a (1 - α) * 100% prediction interval is:

$$ \hat{y} \pm t_{n-2, \alpha/2} \cdot \sqrt{MSE \left( 1 + \frac{1}{n} + \frac{(x - \bar{x})^2}{\sum(x_i - \bar{x})^2} \right)} $$

As you can see, the formula for the prediction interval includes an extra `1` inside the square root. This term accounts for the variance of the individual error term (`σ²`, estimated by `MSE`), making the prediction interval consistently wider than the confidence interval.
